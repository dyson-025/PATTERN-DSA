https://leetcode.com/problems/kth-smallest-element-in-a-sorted-matrix/description/

ğŸ“Œ Kth Smallest Element in a Sorted Matrix

(Matrix sorted row-wise & column-wise)

ğŸ”¹ Problem

Given an n Ã— n matrix where each row and each column is sorted, find the k-th smallest element.

ğŸ§  Key Observation

Matrix is not fully sorted

But rows are sorted â†’ we can count â‰¤ mid efficiently

The count function is monotonic

Larger value â†’ larger count

ğŸ‘‰ This allows Binary Search on VALUE SPACE

ğŸ” Search Space
low  = matrix[0][0]
high = matrix[n-1][n-1]

ğŸ¯ Goal

Find the smallest value X such that:

count(elements â‰¤ X) â‰¥ k

ğŸ§© Algorithm (Step-by-Step)

Binary search on value range [low, high]

For each mid, count elements â‰¤ mid

Use upper_bound in each row

Decision:

If count < k â†’ low = mid + 1

Else â†’ high = mid

When low == high, that value is the answer

âŒ Common Mistake (VERY IMPORTANT)
ğŸš« Wrong
high = mid - 1;

â— Why wrong?

mid can be the answer

Removing it skips the correct value

Breaks for duplicates

âœ… Correct Update Rule
if (count < k)
    low = mid + 1;
else
    high = mid;

ğŸ§  Difference to Remember
Binary Search Type	Update when condition is true
Index-based BS	high = mid - 1
Value-based BS	high = mid
â± Time & Space Complexity

Time:

O(n Ã— log n Ã— log(max - min))


Space:

O(1)

âœ… Correct Code (C++)
int kthSmallest(vector<vector<int>>& matrix, int k) {
    int n = matrix.size();

    int low = matrix[0][0];
    int high = matrix[n - 1][n - 1];

    while (low < high) {
        int mid = low + (high - low) / 2;
        int count = 0;

        for (int i = 0; i < n; i++) {
            count += upper_bound(matrix[i].begin(),
                                 matrix[i].end(), mid)
                     - matrix[i].begin();
        }

        if (count < k)
            low = mid + 1;
        else
            high = mid;
    }

    return low;
}

ğŸ§ª Mini Dry Run

Matrix:

1  5  9
10 11 13
12 13 15


k = 8

Sorted:

1 5 9 10 11 12 13 13 15


Answer = 13

ğŸ§  One-Line Memory Hook

Kth smallest = smallest value with count â‰¥ k

ğŸ¯ Interview Tip

If asked â€œwhy does this work?â€, say:

â€œBecause the count of elements â‰¤ mid is monotonic, enabling binary search on the answer.â€

ğŸŸ¢ Final Note

This question + Matrix Median are same pattern.
Master this once â†’ 2 questions cleared.
